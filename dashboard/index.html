<!DOCTYPE html>
<html lang="tr" class="h-full bg-slate-950">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Metra AI | Portföy Paneli</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#1193d4",
                    },
                },
            },
        };
    </script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700&display=swap" />
    <style>
        body { font-family: 'Work Sans', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
    </style>
</head>
<body class="h-full text-slate-100">
    <div id="app" class="min-h-full">
        <header class="bg-slate-900 border-b border-slate-800">
            <div class="mx-auto flex w-full max-w-6xl items-center justify-between px-4 py-4 sm:px-6">
                <div>
                    <h1 class="text-lg font-semibold text-white">Metra AI Portföy Paneli</h1>
                    <p class="text-sm text-slate-400" id="header_subtitle">Premium danışmanlar için yönetim ekranı</p>
                </div>
                <div class="flex gap-3" id="auth_actions">
                    <button id="logout_button" class="hidden rounded-md bg-slate-800 px-4 py-2 text-sm font-medium text-slate-200 hover:bg-slate-700">Çıkış</button>
                </div>
            </div>
        </header>

        <main class="mx-auto flex w-full max-w-6xl flex-col gap-10 px-4 py-8 sm:px-6">
            <!-- Login View -->
            <section id="login_view" class="mx-auto w-full max-w-xl rounded-2xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-slate-950/40 backdrop-blur">
                <h2 class="text-xl font-semibold text-white">Giriş yap</h2>
                <p class="mt-1 text-sm text-slate-400">
                    Premium yetkili e-posta ve şifrenizle giriş yapın. Oturum açtıktan sonra kendi portföyünüzü yönetebilirsiniz.
                </p>
                <form id="login_form" class="mt-6 space-y-4">
                    <div>
                        <label for="login_email" class="block text-sm font-medium text-slate-300">E-posta</label>
                        <input id="login_email" name="email" type="email" required autocomplete="email" class="mt-1 block w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-slate-100 shadow-sm focus:border-primary focus:outline-none focus:ring-primary" placeholder="ornek@metraai.xyz" />
                    </div>
                    <div>
                        <label for="login_password" class="block text-sm font-medium text-slate-300">Şifre</label>
                        <input id="login_password" name="password" type="password" required autocomplete="current-password" class="mt-1 block w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-slate-100 shadow-sm focus:border-primary focus:outline-none focus:ring-primary" placeholder="••••••••" />
                    </div>
                    <div>
                        <label for="api_base_url" class="block text-sm font-medium text-slate-300">API adresi</label>
                        <input id="api_base_url" name="api_base_url" type="url" required class="mt-1 block w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-slate-100 shadow-sm focus:border-primary focus:outline-none focus:ring-primary" placeholder="https://<railway-projeniz>.up.railway.app" />
                        <p class="mt-1 text-xs text-slate-500">
                            Railway / Render backend URL'inizi girin. Kaydedilir ve sonraki girişlerde otomatik kullanılır.
                        </p>
                    </div>
                    <div>
                        <button type="submit" class="flex w-full items-center justify-center rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-slate-900">
                            Giriş yap
                        </button>
                    </div>
                </form>
                <div id="login_feedback" class="mt-3 text-sm text-rose-400"></div>
            </section>

            <!-- Dashboard View -->
            <section id="dashboard_view" class="hidden space-y-8">
                <div class="grid gap-4 rounded-2xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-slate-950/40 backdrop-blur sm:grid-cols-2">
                    <div>
                        <h2 class="text-lg font-semibold text-white">Oturum bilgileri</h2>
                        <dl class="mt-3 space-y-1 text-sm text-slate-300">
                            <div class="flex gap-2">
                                <dt class="w-24 text-slate-400">Danışman</dt>
                                <dd id="current_user_name" class="font-medium">-</dd>
                            </div>
                            <div class="flex gap-2">
                                <dt class="w-24 text-slate-400">E-posta</dt>
                                <dd id="current_user_email">-</dd>
                            </div>
                            <div class="flex gap-2">
                                <dt class="w-24 text-slate-400">API</dt>
                                <dd id="current_api_base" class="truncate text-emerald-400">-</dd>
                            </div>
                        </dl>
                    </div>
                    <div>
                        <h2 class="text-lg font-semibold text-white">Durum</h2>
                        <p id="dashboard_status" class="mt-3 text-sm text-slate-300">
                            Portföy listeniz sağda yer alır. Yeni ilan ekleyebilir, mevcut ilanları düzenleyebilir veya silebilirsiniz.
                        </p>
                        <p id="last_sync_time" class="mt-2 text-xs text-slate-500">Son güncelleme: -</p>
                    </div>
                </div>

                <div class="grid gap-6 lg:grid-cols-[350px_1fr]">
                    <div class="rounded-2xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-slate-950/40 backdrop-blur">
                        <div class="flex items-center justify-between">
                            <h3 id="property_form_title" class="text-lg font-semibold text-white">Yeni ilan ekle</h3>
                            <button id="reset_form_button" class="hidden text-xs font-semibold text-slate-400 hover:text-slate-200">Yeni kayıt</button>
                        </div>
                        <form id="property_form" class="mt-4 space-y-4 text-sm text-slate-200">
                            <input type="hidden" id="property_id" />
                            <div>
                                <label class="block text-xs uppercase tracking-wide text-slate-400">Başlık</label>
                                <input id="prop_title" type="text" required class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="Örn. Ankara Çankaya 3+1 Daire" />
                            </div>
                            <div class="grid gap-3 sm:grid-cols-2">
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">Durum</label>
                                    <select id="prop_status" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary">
                                        <option value="satılık">Satılık</option>
                                        <option value="kiralık">Kiralık</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">Kategori</label>
                                    <select id="prop_category" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary">
                                        <option value="arsa">Arsa</option>
                                        <option value="isyeri">İşyeri</option>
                                        <option value="daire">Daire</option>
                                    </select>
                                </div>
                            </div>
                            <div class="grid gap-3 sm:grid-cols-2">
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">Fiyat</label>
                                    <input id="prop_price" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="8.500.000 ₺" />
                                </div>
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">Konum</label>
                                    <input id="prop_location" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="Çankaya / Ankara" />
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs uppercase tracking-wide text-slate-400">Öne çıkan cümle</label>
                                <input id="prop_tagline" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="Şehir merkezine 5 dk mesafe" />
                            </div>
                            <div>
                                <label class="block text-xs uppercase tracking-wide text-slate-400">Kısa açıklama</label>
                                <textarea id="prop_description" rows="3" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="Mülk hakkında kısa bilgi..."></textarea>
                            </div>
                            <div>
                                <label class="block text-xs uppercase tracking-wide text-slate-400">Görsel URL</label>
                                <input id="prop_image_url" type="url" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="https://resim.ornek.com/foto.jpg" />
                            </div>
                            <div class="grid gap-3 sm:grid-cols-2">
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">Metrekare</label>
                                    <input id="prop_area" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="150 m²" />
                                </div>
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">Oda sayısı</label>
                                    <input id="prop_rooms" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="3+1" />
                                </div>
                            </div>
                            <div class="grid gap-3 sm:grid-cols-2">
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">İmar durumu</label>
                                    <input id="prop_zoning" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="Konut" />
                                </div>
                                <div>
                                    <label class="block text-xs uppercase tracking-wide text-slate-400">Bulunduğu kat</label>
                                    <input id="prop_floor" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="4. Kat" />
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs uppercase tracking-wide text-slate-400">Bina yaşı</label>
                                <input id="prop_building_age" type="text" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="2" />
                            </div>
                            <div>
                                <label class="block text-xs uppercase tracking-wide text-slate-400">Öne çıkan özellikler</label>
                                <textarea id="prop_specs" rows="2" class="mt-1 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary" placeholder="Örn. Açık mutfak, Kapalı otopark, Güvenlik"></textarea>
                                <p class="mt-1 text-xs text-slate-500">Birden fazla özellik için virgül kullanın.</p>
                            </div>
                            <div class="flex items-center gap-2">
                                <input id="prop_featured" type="checkbox" class="h-4 w-4 rounded border-slate-700 bg-slate-900 text-primary focus:ring-primary" />
                                <label for="prop_featured" class="text-xs uppercase tracking-wide text-slate-400">Vitrinde öne çıkar</label>
                            </div>
                            <button id="property_submit_button" type="submit" class="w-full rounded-md bg-primary px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-slate-900">
                                İlanı kaydet
                            </button>
                            <p id="property_form_feedback" class="text-xs text-rose-400"></p>
                        </form>
                    </div>

                    <div class="rounded-2xl border border-slate-800 bg-slate-900/70 p-6 shadow-lg shadow-slate-950/40 backdrop-blur">
                        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                            <h3 class="text-lg font-semibold text-white">Portföyüm</h3>
                            <div class="flex items-center gap-2">
                                <label for="filter_status" class="text-xs uppercase tracking-wide text-slate-400">Durum</label>
                                <select id="filter_status" class="rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-white focus:border-primary focus:outline-none focus:ring-primary">
                                    <option value="">Tümü</option>
                                    <option value="satılık">Satılık</option>
                                    <option value="kiralık">Kiralık</option>
                                </select>
                            </div>
                        </div>
                        <div id="properties_empty" class="mt-10 hidden rounded-lg border border-dashed border-slate-700 bg-slate-900/40 p-6 text-center text-sm text-slate-400">
                            Henüz portföyünüzde ilan yok. Soldaki formdan ilk ilanınızı ekleyin.
                        </div>
                        <div class="mt-6 overflow-x-auto">
                            <table class="min-w-full divide-y divide-slate-800 text-sm">
                                <thead class="bg-slate-900/70 text-xs uppercase tracking-wide text-slate-400">
                                    <tr>
                                        <th class="px-3 py-2 text-left font-medium">Başlık</th>
                                        <th class="px-3 py-2 text-left font-medium">Durum</th>
                                        <th class="px-3 py-2 text-left font-medium">Kategori</th>
                                        <th class="px-3 py-2 text-left font-medium">Fiyat</th>
                                        <th class="px-3 py-2 text-left font-medium">Özellikler</th>
                                        <th class="px-3 py-2 text-right font-medium">İşlemler</th>
                                    </tr>
                                </thead>
                                <tbody id="properties_table_body" class="divide-y divide-slate-800"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <template id="property_row_template">
        <tr class="hover:bg-slate-900/70">
            <td class="px-3 py-3 align-top text-sm font-medium text-white"></td>
            <td class="px-3 py-3 align-top text-sm capitalize"></td>
            <td class="px-3 py-3 align-top text-sm uppercase tracking-wide text-slate-300"></td>
            <td class="px-3 py-3 align-top text-sm text-emerald-400"></td>
            <td class="px-3 py-3 align-top text-xs text-slate-300"></td>
            <td class="px-3 py-3 align-top text-right text-xs">
                <div class="flex justify-end gap-2">
                    <button data-action="edit" class="rounded-md border border-slate-700 px-3 py-1 text-xs font-semibold text-slate-200 hover:bg-slate-800">Düzenle</button>
                    <button data-action="delete" class="rounded-md border border-rose-500/40 bg-rose-500/10 px-3 py-1 text-xs font-semibold text-rose-300 hover:bg-rose-500/20">Sil</button>
                </div>
            </td>
        </tr>
    </template>

    <script src="./dashboard.js" defer></script>
</body>
</html>
